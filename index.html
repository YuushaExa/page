<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visual Novels</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .vn-container {
      border: 1px solid #ddd;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 5px;
    }
    .vn-title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .vn-title a {
      text-decoration: none;
      color: #007bff;
      cursor: pointer;
    }
    .vn-title a:hover {
      text-decoration: underline;
    }
    .vn-description {
      font-size: 16px;
      color: #555;
      margin-bottom: 10px;
    }
    .vn-image {
      max-width: 100%;
      height: auto;
      margin-bottom: 10px;
    }
    .vn-developers, .vn-tags, .vn-screenshots {
      margin-bottom: 10px;
    }
    .vn-developers ul, .vn-tags ul, .vn-screenshots ul {
      list-style-type: none;
      padding: 0;
    }
    .vn-developers li, .vn-tags li {
      display: inline-block;
      margin-right: 10px;
      background-color: #f0f0f0;
      padding: 5px 10px;
      border-radius: 3px;
    }
    .vn-screenshots img {
      max-width: 100px;
      margin-right: 10px;
    }
    .pagination {
      margin-top: 20px;
      text-align: center;
    }
    .pagination a {
      margin: 0 5px;
      text-decoration: none;
      color: #007bff;
    }
    .pagination a.active {
      font-weight: bold;
      color: #000;
    }
    .back-button {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Initial content (list of visual novels) -->
    <h1>Visual Novels</h1>
    <div id="vn-list"></div>
    <div id="pagination" class="pagination"></div>
  </div>

  <script>
    const baseUrl = 'https://yuushaexa.github.io';
    let currentPage = 1;

    // Function to fetch and display visual novels
    async function fetchVisualNovels(page = 1) {
      try {
        const url = `${baseUrl}/vn.json?page=${page}`;
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        const data = await response.json();
        renderVisualNovels(data.posts);
        renderPagination(data.pagination);
        currentPage = page; // Update the current page
      } catch (error) {
        console.error('Error fetching visual novels:', error);
      }
    }

    // Function to render visual novels
    function renderVisualNovels(posts) {
      const vnList = document.getElementById('vn-list');
      if (!vnList) {
        console.error('Element with id "vn-list" not found.');
        return;
      }
      vnList.innerHTML = ''; // Clear existing content

      posts.forEach(vn => {
        const vnContainer = document.createElement('div');
        vnContainer.className = 'vn-container';

        // Make the title clickable
        const title = document.createElement('div');
        title.className = 'vn-title';
        const titleLink = document.createElement('a');
        titleLink.textContent = vn.title;
        titleLink.addEventListener('click', () => fetchAndRenderDetails(`${baseUrl}${vn.link}.json`));
        title.appendChild(titleLink);
        vnContainer.appendChild(title);

        const description = document.createElement('div');
        description.className = 'vn-description';
        description.textContent = vn.description;
        vnContainer.appendChild(description);

        if (vn.image && vn.image.url) {
          const image = document.createElement('img');
          image.className = 'vn-image';
          image.src = vn.image.url;
          image.alt = vn.title;
          vnContainer.appendChild(image);
        }

        if (vn.developers && vn.developers.length > 0) {
          const developers = document.createElement('div');
          developers.className = 'vn-developers';
          const devList = document.createElement('ul');
          vn.developers.forEach(dev => {
            const devItem = document.createElement('li');
            devItem.textContent = dev.name;
            devList.appendChild(devItem);
          });
          developers.appendChild(devList);
          vnContainer.appendChild(developers);
        }

        if (vn.tags && vn.tags.length > 0) {
          const tags = document.createElement('div');
          tags.className = 'vn-tags';
          const tagList = document.createElement('ul');
          vn.tags.forEach(tag => {
            const tagItem = document.createElement('li');
            tagItem.textContent = tag;
            tagList.appendChild(tagItem);
          });
          tags.appendChild(tagList);
          vnContainer.appendChild(tags);
        }

        if (vn.screenshots && vn.screenshots.length > 0) {
          const screenshots = document.createElement('div');
          screenshots.className = 'vn-screenshots';
          const screenshotList = document.createElement('ul');
          vn.screenshots.forEach(screenshot => {
            const screenshotItem = document.createElement('li');
            const screenshotImg = document.createElement('img');
            screenshotImg.src = screenshot.url;
            screenshotImg.alt = 'Screenshot';
            screenshotItem.appendChild(screenshotImg);
            screenshotList.appendChild(screenshotItem);
          });
          screenshots.appendChild(screenshotList);
          vnContainer.appendChild(screenshots);
        }

        vnList.appendChild(vnContainer);
      });
    }

    // Function to fetch and render details for a specific visual novel
    async function fetchAndRenderDetails(url) {
      try {
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        const vnDetails = await response.json();
        renderDetails(vnDetails);
      } catch (error) {
        console.error('Error fetching visual novel details:', error);
      }
    }

    // Function to render details for a specific visual novel
    function renderDetails(vn) {
      const app = document.getElementById('app');
      if (!app) {
        console.error('Element with id "app" not found.');
        return;
      }
      app.innerHTML = ''; // Clear existing content

      // Add a back button
      const backButton = document.createElement('button');
      backButton.textContent = 'Back to List';
      backButton.className = 'back-button';
      backButton.addEventListener('click', () => {
        fetchVisualNovels(currentPage); // Return to the previous page
      });
      app.appendChild(backButton);

      // Render the details
      const details = document.createElement('div');
      details.className = 'vn-container';

      const title = document.createElement('div');
      title.className = 'vn-title';
      title.textContent = vn.title;
      details.appendChild(title);

      const description = document.createElement('div');
      description.className = 'vn-description';
      description.textContent = vn.description;
      details.appendChild(description);

      if (vn.image && vn.image.url) {
        const image = document.createElement('img');
        image.className = 'vn-image';
        image.src = vn.image.url;
        image.alt = vn.title;
        details.appendChild(image);
      }

      if (vn.developers && vn.developers.length > 0) {
        const developers = document.createElement('div');
        developers.className = 'vn-developers';
        const devList = document.createElement('ul');
        vn.developers.forEach(dev => {
          const devItem = document.createElement('li');
          devItem.textContent = dev.name;
          devList.appendChild(devItem);
        });
        developers.appendChild(devList);
        details.appendChild(developers);
      }

      if (vn.tags && vn.tags.length > 0) {
        const tags = document.createElement('div');
        tags.className = 'vn-tags';
        const tagList = document.createElement('ul');
        vn.tags.forEach(tag => {
          const tagItem = document.createElement('li');
          tagItem.textContent = tag;
          tagList.appendChild(tagItem);
        });
        tags.appendChild(tagList);
        details.appendChild(tags);
      }

      if (vn.screenshots && vn.screenshots.length > 0) {
        const screenshots = document.createElement('div');
        screenshots.className = 'vn-screenshots';
        const screenshotList = document.createElement('ul');
        vn.screenshots.forEach(screenshot => {
          const screenshotItem = document.createElement('li');
          const screenshotImg = document.createElement('img');
          screenshotImg.src = screenshot.url;
          screenshotImg.alt = 'Screenshot';
          screenshotItem.appendChild(screenshotImg);
          screenshotList.appendChild(screenshotItem);
        });
        screenshots.appendChild(screenshotList);
        details.appendChild(screenshots);
      }

      app.appendChild(details);
    }

    // Function to render pagination
    function renderPagination(pagination) {
      const paginationContainer = document.getElementById('pagination');
      if (!paginationContainer) {
        console.error('Element with id "pagination" not found.');
        return;
      }
      paginationContainer.innerHTML = ''; // Clear existing content

      if (pagination.previousPage) {
        const prevLink = document.createElement('a');
        prevLink.href = `#${pagination.previousPage}`;
        prevLink.textContent = 'Previous';
        prevLink.addEventListener('click', (e) => {
          e.preventDefault();
          fetchVisualNovels(pagination.currentPage - 1);
        });
        paginationContainer.appendChild(prevLink);
      }

      const currentPageSpan = document.createElement('span');
      currentPageSpan.textContent = `Page ${pagination.currentPage} of ${pagination.totalPages}`;
      paginationContainer.appendChild(currentPageSpan);

      if (pagination.nextPage) {
        const nextLink = document.createElement('a');
        nextLink.href = `#${pagination.nextPage}`;
        nextLink.textContent = 'Next';
        nextLink.addEventListener('click', (e) => {
          e.preventDefault();
          fetchVisualNovels(pagination.currentPage + 1);
        });
        paginationContainer.appendChild(nextLink);
      }
    }

    // Fetch and display visual novels when the page loads
    document.addEventListener('DOMContentLoaded', () => {
      fetchVisualNovels(1); // Fetch the first page by default
    });
  </script>
</body>
</html>
